{% extends "layout.html" %}

{% block content %}
<h1>Settings</h1>

<div class="card">
    <form action="{{ url_for('settings') }}" method="POST">
        <h3>Sender Information</h3>
        <div class="form-group">
            <label>Name</label>
            <input type="text" name="sender_name" value="{{ settings.get('sender_name', '') }}">
        </div>
        <div class="form-group">
            <label>Address Line 1</label>
            <input type="text" name="sender_address_line1" value="{{ settings.get('sender_address_line1', '') }}">
        </div>
        <div class="form-group">
            <label>Address Line 2</label>
            <input type="text" name="sender_address_line2" value="{{ settings.get('sender_address_line2', '') }}">
        </div>
        <div class="form-group">
            <label>Address Line 3</label>
            <input type="text" name="sender_address_line3" value="{{ settings.get('sender_address_line3', '') }}">
        </div>
        <div class="form-group">
            <label>Email</label>
            <input type="email" name="sender_email" value="{{ settings.get('sender_email', '') }}">
        </div>
        <div class="form-group">
            <label>Phone</label>
            <input type="text" name="sender_phone" value="{{ settings.get('sender_phone', '') }}">
        </div>
        <div class="form-group">
            <label>Tax Identification Number</label>
            <input type="text" name="tax_id" value="{{ settings.get('tax_id', '') }}">
        </div>

        <h3>Bank Details</h3>
        <div class="form-group">
            <label>IBAN</label>
            <input type="text" name="bank_iban" value="{{ settings.get('bank_iban', '') }}">
        </div>
        <div class="form-group">
            <label>Account Holder Name (for Payment)</label>
            <input type="text" name="bank_account_holder" value="{{ settings.get('bank_account_holder', '') }}">
        </div>
        <div class="form-group">
            <label>SWIFT / BIC</label>
            <input type="text" name="bank_swift" value="{{ settings.get('bank_swift', '') }}">
        </div>

        <h3>Finance</h3>
        <div class="form-group">
            <label>VAT Percentage (%)</label>
            <input type="number" name="vat_percentage" step="0.01" value="{{ settings.get('vat_percentage', '11') }}">
        </div>

        <button type="submit" class="btn btn-primary">Save Settings</button>
    </form>

    <hr style="margin: 30px 0;">

    <h3>Data Management</h3>
    <div style="display: flex; gap: 20px; flex-wrap: wrap;">
        <div style="flex: 1; min-width: 300px;">
            <h4>Export Data</h4>
            <div class="card" style="padding: 15px; background: #f8f9fa;">
                <p>Download a backup of all clients, invoices, and settings.</p>
                <a href="{{ url_for('export_data') }}" class="btn btn-secondary" style="background-color: #6c757d; border-color: #6c757d;">Export to JSON</a>
            </div>
        </div>
        <div style="flex: 1; min-width: 300px;">
            <h4>Import Data</h4>
            <div class="card" style="padding: 15px; background: #fff3cd;">
                <p>Restore data from backup. <strong>Overwrites existing data.</strong></p>
                <form action="{{ url_for('import_data') }}" method="POST" enctype="multipart/form-data" 
                      onsubmit="return confirm('WARNING: This will DELETE all current data and replace it with the imported file. This action cannot be undone. Proceed?');">
                    <div class="form-group">
                        <input type="file" name="file" accept=".json" required>
                    </div>
                    <button type="submit" class="btn btn-warning" style="background-color: #ffc107; border-color: #ffc107; color: #212529;">Import JSON</button>
                </form>
            </div>
        </div>
    </div>

    <hr style="margin: 30px 0;">

    <h3>Application Contol</h3>
    <p>The application runs in the background. Use this button to fully close it.</p>
    <form action="{{ url_for('shutdown') }}" method="POST"
        onsubmit="return confirm('Are you sure you want to shut down the application?');">
        <button type="submit" class="btn btn-danger" style="background-color: #dc3545; border-color: #dc3545;">Shutdown
            Application</button>
    </form>
</div>
{% endblock %}